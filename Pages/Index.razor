@page "/"
@using SWH.Models
@using SWH.Interfaces
@using MongoDB.Driver.Linq
@inject IProduct ProductController
@inject IShelf ShelfController
@inject IColumn ColumnController

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>
<MudButton OnClick="addProduct">add product</MudButton>
<MudButton OnClick="addShelf">add shelf</MudButton>
<MudButton OnClick="addColumn">add column</MudButton>

<MudButton OnClick="getshelves">get shelves</MudButton>

Welcome to your new app.

@code{
    List<Shelf> _shelves = new();
    Product p = new()
    {
        Name = "P1",
        Price = 15.99
    };

    Shelf s = new()
    {
        Name = "Shelf1",
    //add to products list
        Products = new List<Product>
        {
            new Product
            {
                Name = "P2",
                Price = 8.99
            },
            new Product
            {
                Name = "P3",
                Price = 11.99
            },
        }

    };

    public void addProduct()
    {
        ProductController.AddProduct(p);
    }

    public void addShelf()
    {
        ShelfController.AddShelf(s);
    }

    private void addColumn()
    {
        Column column = new()
        {
            Name = "1",
            Shelves = _shelves
        };
        
        ColumnController.AddColumn(column);
    }

    public async void getshelves()
    {
         var  shelves = await ShelfController.GetAllShelves();
        _shelves = shelves;
        foreach (var shelf in shelves)
        {
            Console.WriteLine(shelf);
            Console.WriteLine(shelf.Name);
            int count = 0;
            foreach (var product in shelf.Products)
            {
                Console.WriteLine(product.Name + " " + product.Price);
                Console.WriteLine(shelf.Products[count] + "asdasd");
                count++;
            }
        }
        Console.WriteLine(shelves);
    }
    
   

}